
# 发票合并工具 · 产品文档（Tauri 版本 PRD）

## 1. 产品名称
**Master Concept Invoice Merge Assistant (MC-IMA)**  
Tauri 桌面版（macOS / Windows）

## 2. 产品定位
一款基于 Tauri 的跨平台桌面小工具，只解决一件事：

> 把一个文件夹里的所有发票相关文件（PDF / 图片 / HEIC）一键合并成一个标准 PDF，全部本地完成，无广告、不开网络、不绑定账号。

特点：
- 纯本地处理，适合包含个人隐私/公司信息的发票场景
- 体积小（得益于 Tauri），安装干净
- 操作极简：选文件夹 → 选排序 → 合并输出

## 3. 目标用户
- 经常报销的员工（销售、顾问、实施、运营等）
- 需要整理客户发票附件的财务人员、项目经理
- 经常需要把图片、扫描件统一成一个 PDF 的任何人

## 4. 核心使用场景
1. **报销前整理发票**
   - 用户在不同渠道获取到 PDF 电子发票、手机拍照票据（JPG/HEIC）、扫码下载的发票 PDF
   - 手工把要报销的发票放到一个文件夹
   - 启动本工具 → 选择该文件夹 → 一键合并生成 `merged_invoices_xxx.pdf`
2. **整理客户资料**
   - 客户发来若干个分散的账单/收据
   - 合并成一个文件，上传到 OA/ERP/Drive

## 5. 功能范围（MVP）

### 5.1 必须有
- 选择一个「发票文件夹」
- 扫描文件夹中的发票文件：
  - 支持扩展名：`.pdf`, `.jpg`, `.jpeg`, `.png`, `.heic`
- 在界面中展示文件列表：
  - 文件图标（按类型）
  - 文件名
  - 最后修改时间
- 排序方式：
  - 按文件名升序
  - 按修改时间升序
- 合并输出：
  - 所有 PDF 直接拼接
  - 所有图片（含 HEIC）转换成 A4 纵向 PDF 页面后加入
  - 输出文件命名：`merged_invoices_YYYYMMDD_HHMM.pdf`
  - 输出存放在原文件夹内
- 操作反馈：
  - 合并进度（简单进度条 / 百分比）
  - 成功提示（显示输出路径，带“打开所在文件夹”按钮）
  - 失败提示（给出简要错误信息）

### 5.2 可选（Nice to have）
- 手动调整排序（拖拽文件顺序）
- 过滤非发票类文件（例如 `.txt`, `.ds_store` 自动忽略）
- 输出文件名允许自定义前缀
- 记住上次使用的目录路径

### 5.3 明确不做（MVP 之外）
- 不做 OCR / 文本识别
- 不识别发票金额、抬头等结构化信息
- 不生成报销表格（Excel / Sheet）
- 不上传云端 / 不做协作 / 不做账号体系
- 不对接任何第三方 API

## 6. 用户流程（User Flow）

```text
[启动应用]
      ↓
[主界面：空列表，提示选择发票文件夹]
      ↓
[点击「选择文件夹」 → 系统文件选择对话框]
      ↓
[展示文件夹内所有支持的文件类型，按默认排序显示]
      ↓
[用户可切换排序方式（文件名 / 修改时间）或手动拖拽排序（可选）]
      ↓
[点击「合并并导出 PDF」]
      ↓
[显示进度条：正在处理第 N/总数个文件 ⇒ 正在合并]
      ↓
[完成后弹窗：合并完成！路径：xxx/merged_invoices_YYYYMMDD_HHMM.pdf]
      ↓
[用户点击「打开文件夹」或「完成」]
```

## 7. 关键 UX 细节

- **零心智负担**：不需要任何配置或学习成本。
- **错误可见但不打扰**：
  - 如果单个文件解析失败，不要让整个流程崩掉：
    - 在结果弹窗中展示「有 1 个文件失败，可在日志中查看详情」
- **状态清晰**：
  - 未选择文件夹 → 提示文字居中
  - 已选择文件夹 → 顶部显示「当前文件夹：xxx」

## 8. 成功指标（简单版）

- 绝大多数用户在首次使用时，无需阅读说明即可完成一次成功合并。
- 对 100 个混合（PDF + 图片 + HEIC）发票文件的处理，耗时在 3–5 秒级别（视机型不同，可接受 10 秒内）。
- 不出现损坏的 PDF / 无法打开的输出文件。

## 9. 未来扩展方向（非本次范围）

- 批量模式：选择多个文件夹，一次性为每个文件夹输出一个合并 PDF
- 封面页：自动生成一页「发票清单」目录
- 支持命令行模式：`mc-invoice-merge <folder>` 直接合并
- 与「报销表格工具」对接，形成一个 mini 套件
