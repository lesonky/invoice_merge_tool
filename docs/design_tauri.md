
# 发票合并工具 · Tauri UI 设计稿（文字版）

## 1. 窗口布局（主界面）

目标：在 800×520 左右的窗口内，清晰展示三块内容：当前目录、文件列表、操作按钮。

```text
┌──────────────────────────────────────────────────────────┐
│ Master Concept 发票合并助手                    [ ☐  ✕ ] │
├──────────────────────────────────────────────────────────┤
│ 当前文件夹： [ 未选择 ]                         [ 选择文件夹 ] │
├──────────────────────────────────────────────────────────┤
│ 排序方式： (●) 按文件名  ( ) 按修改时间                  │
│                                                          │
│ ┌──────────────────────────────────────────────────────┐ │
│ │ 文件名                    类型    修改时间       大小 │ │
│ │----------------------------------------------------│ │
│ │ invoice_001.pdf           PDF   2025-10-28 10:23  88K│ │
│ │ IMG_0001.HEIC             图片   2025-10-28 09:12  2M │ │
│ │ ticket123.jpg             图片   2025-10-27 21:03  1.2M││
│ │ ...                                               ... ││
│ └──────────────────────────────────────────────────────┘ │
│                                                          │
│ [ 合并并导出 PDF ]          进度： [██████      ]  60%   │
│                                                          │
│ 状态：就绪。                                             │
└──────────────────────────────────────────────────────────┘
```

## 2. 交互细节

### 2.1 选择文件夹

- 点击「选择文件夹」按钮，调用 Tauri 的 `dialog.open({ directory: true })`。
- 用户选择后：
  - 顶部「当前文件夹」更新为完整路径 / 或缩略显示（中间省略）。
  - 自动调用 `scan_folder_cmd`，刷新文件列表。
  - 如扫描失败，在状态栏显示错误信息。

### 2.2 文件列表

- 列头：
  - 文件名
  - 类型（PDF / 图片）
  - 修改时间（本地时间，格式：YYYY-MM-DD HH:mm）
  - 大小（自动格式化 kB / MB）

- 行样式：
  - 奇偶行背景略有区别（提升可读性）
  - 鼠标悬停高亮
  - （可选）双击行 → 弹出系统默认应用打开该文件（使用 Tauri `shell.open`）

### 2.3 排序方式

- 单选按钮：
  - 「按文件名」：前端对 `files` 进行 `file_name` 字符串排序（localeCompare）
  - 「按修改时间」：对 `modified_ts` 排序
- 排序切换后立即更新列表，不影响原始数据结构（前端内部保持 sorted 数组）

### 2.4 合并与进度条

- 点击「合并并导出 PDF」后：
  - 按钮进入禁用状态（防止重复点击）
  - 状态栏显示「正在合并，请稍候…」
  - 进度条缓慢从 0% 增长到 80%（假进度），待后端返回成功后直接跳到 100%
- 收到结果：
  - 成功：
    - 弹出对话框：「合并完成！输出文件：xxx」
    - 提供两个按钮：「打开所在文件夹」「关闭」
  - 失败：
    - 弹出对话框：「合并失败」，显示后端返回的错误信息，并在状态栏留下错误文案

### 2.5 状态栏

- 显示当前状态信息：
  - 「就绪。」
  - 「已选择文件夹：xxx，共检出 N 个文件。」
  - 「合并中（3/25）…」
  - 「合并完成：xxx/merged_invoices_YYYYMMDD_HHMM.pdf」

## 3. 视觉风格建议（参考 Tailwind / Radix UI）

- 背景：`#F9FAFB`（浅灰）
- 顶部栏：白底 + 轻微阴影
- 主文字：`#111827`
- 辅助文字：`#6B7280`
- 主按钮（合并）：
  - 背景：`#4F46E5`（Indigo）
  - 悬停：`#4338CA`
  - 禁用：亮度降低 + 光标 not-allowed

## 4. 空状态设计

- 未选择任何目录时：
  - 文件列表区域显示一个空状态插画（可选）+ 文案：

```text
尚未选择发票文件夹

请点击上方「选择文件夹」按钮，选择一个包含发票 PDF / 图片的文件夹。
```

## 5. 错误状态设计

- 目录不可读 / 无权限：
  - 对话框：「无法读取该目录，请确认权限或选择其他目录。」
- 目录下没有任何支持的文件：
  - 列表区域显示：

```text
未找到任何支持的文件（PDF / JPG / PNG / HEIC）。

请确认所选目录中包含发票文件。
```

## 6. 未来扩展 UI 预留

- 排序行下方可预留一个简易 Filter：
  - 「仅显示 PDF」「仅显示图片」
- 在列表上方增加一个只读提示：
  - 「当前仅展示支持合并的文件类型，其它文件已自动忽略。」
